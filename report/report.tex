\documentclass{report}

\title{Image Analysis Assignement}
\author{Deguerre Benjamin}

\begin{document}
\maketitle
\section{Introduction}
The aim of this assignment is to analyses omages of a railway crossing in order to dectect different evenments. The differents events are the following :
  \begin{itemize}
    \item Event 0 : there is no event;
    \item Event 1 : The railway track is not clear of road/pedestrian traffic;
    \item Event 2 : a road vehicule is entering the railway line crossing;
    \item Event 3 : a road vehicule is leaving the railway line crossing;
    \item Event 4 : the level crossing safety barrier is deployed;
    \item Event 5 : rail traffic is currently using the railway track;
  \end{itemize}

The procedure in order to detect each of the events will be the following one, first, trying to detect each of the events separatly and if none detected then we can safely say the scene if empty (given the error in the previous ones).

\section{Train Detection}
For this part a SVM model was used in order to affiche rather good performance, since train are quite a big part of the image it was obvious that the svm method would work well.
In order to train the model the following scheme was followed. First we use a mask of the zone A to remove everything from the image apart from what's on the tracks. Then we train the model with a set of images taken from the database previously set from color to Black and White images. Since the set of images is not that big, if with more testing, we where to find loss in the percentage of good results, we could use the three channels of the image separatly in order to improve our model and use a technique of the most takes the win.
One of the main problem i found so far is that for some train leaving the image, the model is not very well trained and can miss it. In order to conpensate for that we use the shape detection of the cars to find small shape in small area at the ending of the tracks on the picture.

\section{Car Detection}
For the car detection we make the difference between two type of cars, the white ones and the others.

In order to detect the non white cars, we follow this workflow :
\begin{itemize}
  \item Taking an image of the empty scene and substract the current analysed image;
  \item go to the balck and white space;
  \item using the log transform to increase the range of the dark pixels;
  \item threshold the image to get the cars in black;
  \item apply masks to remove the useless parts (letters, dates, ...);
  \item apply the canny algorithm to get the shapes of the cars;
  \item then apply the function findContours to get the contours of the cars;
  \item apply the convex hull algorithm to find an enclosing shape;
  \item remove the shapes that are made from noise.
\end{itemize}

For the white cars, we follow the same principle but at the first step we substract the empty scene to the current analysed image;

Once we have all the shapes, in order to find which event we should trigger, we calculate the center of mass of each shape in order to define if the shape is inside one of the zone. And it is also at this moment that we compansate for the lack of precision in the svm model by detecting shapes at the end of the tracks.



\section{Barrier Detection}

For the barrier detection I used the line finder class from the opencv example in the blackboard. This class makes use of the HoughLinesP function in order to select only one line in a potential set of lines. Then in order to select only the line that were relevant to the barrier, i selected the point from the extremity of the detected line and I compared to the probable start of the actual barrier.
This allow to detect the barrier pretty well and avoid detecting the shadow that sometimes pollute the image.

\section{Pedestrian Detection}

\section{Results}
The results will be separated in two part, the first one will give us numbers without the data used to train the svm model for the train. Then the second set of results will be given using all of the image, but one have to keep in mind the result won't be completely accurate because of the training, espacially for the train detection.

Reduce set :

\begin{tabular}{|c|c|c|c|}
  \hline
  colonne 1 & Correctly detected & Correctly not detected & False Positive & Undetected \\
  \hline
  Event 0 & 100 & 1.2 & 90 & 1.2  \\
  \hline
  Event 1 & 95.16 & 1.2 & 1.3 & 1.2 \\
  \hline
  Event 2 & 1.2 & 1.2 & 1.3 & 96.15 \\
  \hline
  Event 3 & 1.2 & 1.2 & 1.3 & 1.2 \\
  \hline
  Event 4 & 1.2 & 1.2 & 1.3 & 1.2 \\
  \hline
  Event 5 & 1.2 & 1.2 & 1.3 & 1.2 \\
  \hline
\end{tabular}

Full set:

\begin{tabular}{|c|c|c|c|}
  \hline
  colonne 1 & Correctly detected & Correctly not detected & False Positive & Undetected \\
  \hline
  Event 0 & 95 & 1.2 & 90 & 1.2  \\
  \hline
  Event 1 & 96.03 & 1.2 & 1.3 & 1.2 \\
  \hline
  Event 2 & 1.2 & 1.2 & 1.3 & 96.15 \\
  \hline
  Event 3 & 1.2 & 1.2 & 1.3 & 1.2 \\
  \hline
  Event 4 & 1.2 & 1.2 & 1.3 & 1.2 \\
  \hline
  Event 5 & 1.2 & 1.2 & 1.3 & 1.2 \\
  \hline
\end{tabular}

\section{Conclusion}

\end{document}
